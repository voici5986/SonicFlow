# 全局智能搜索与账号布局重构方案 (Global Search & Header Layout)

本方案旨在解决桌面端账号信息被播放器遮挡的问题，并引入一套高效的、基于上下文感知的全局搜索系统。

---

## 核心设计理念
- **全局入口**：搜索不再分散在各个页面，而是作为应用顶层的常驻功能。
- **智能路由**：搜索栏会自动识别用户当前所处的页面，并智能切换搜索范围。
- **视觉平衡**：通过顶部 Header 承载搜索与账号，释放侧边栏空间，构建稳定的视觉三角。

---

## 分阶段实施步骤

### 阶段一：基础框架与账号迁移 (Structural Foundation)
**目标**：构建顶部 Header 框架并解决账号信息遮挡问题。

1. **创建全局 Header 组件**：
   - 在 `src/components` 下新建 `Header.js`。
   - 实现响应式布局：桌面端显示，移动端隐藏（或作为顶部窄条）。
2. **布局调整 (`App.js`)**：
   - 在 `MainContent` 容器顶部注入 `Header`。
   - 调整侧边栏样式，移除底部的账号信息模块。
   - 增加内容区的 `padding-top` 以适配 Header 高度。
3. **账号组件重构**：
   - 将账号信息（头像、用户名）封装为 `UserHeaderItem` 放入 Header 右上角。
   - 添加下拉菜单：包含“个人中心”、“设置”、“退出登录”等功能。

### 阶段二：智能上下文搜索逻辑 (Smart Search Logic)
**目标**：实现搜索栏的“读心术”，根据页面自动切换功能。

1. **搜索栏状态管理**：
   - 在全局 Context 中维护搜索关键词和当前的搜索上下文（Context）。
2. **上下文识别路由**：
   - 监听 `activeTab` 状态：
     - `home` / `user` -> 执行 **全库音乐搜索**。
     - `favorites` -> 执行 **当前收藏列表过滤**。
     - `history` -> 执行 **播放历史记录过滤**。
3. **UI 反馈增强**：
   - 在搜索框左侧添加动态占位符或标签（如：`🔍 在收藏中搜索...`）。
   - 实现“一键切换”逻辑：在局部页面搜索时，允许用户通过快捷键或点击切换到全库搜索。

### 阶段三：交互体验与微动效 (Interaction & Aesthetics)
**目标**：打造 Notion 级别的丝滑感。

1. **毛玻璃与阴影**：
   - Header 采用 `backdrop-filter: blur()` 毛玻璃效果。
   - 滚动时增加细微的阴影或边框线条感。
2. **快捷键支持**：
   - 全局支持 `Ctrl + K` (或 `Cmd + K`) 快速聚焦搜索框。
   - 支持 `Esc` 退出搜索。
3. **结果预览面板**：
   - 搜索框输入时，下方弹出精美的预览浮层，而不是直接跳转/刷新页面。
   - 预览层支持键盘箭头键选择。

---

## 技术难点与考量
- **搜索性能**：局部过滤（收藏/历史）应为纯前端实时过滤，全库搜索需防抖处理。
- **组件通信**：Header 中的搜索框需要能触发不同页面组件内部的过滤函数。
- **移动端适配**：在小屏幕上，Header 搜索框可能需要收缩为一个图标，点击后再展开。

---

## 未来扩展建议
- **指令系统**：支持在搜索框输入 `/` 触发命令（如 `/play` 播放，`/clear` 清空缓存）。
- **多标签页搜索**：在搜索预览中同时显示来自全库、收藏、历史的匹配结果，按分类排列。
