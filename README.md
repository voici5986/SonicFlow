# SonicFlow (åŸCL-Music) å…¨å¹³å°éŸ³ä¹æœç´¢

ä¸€æ¬¾åŸºäºReactå¼€å‘çš„åœ¨çº¿éŸ³ä¹æœç´¢å’Œæ’­æ”¾åº”ç”¨ã€‚
[![Netlify Status](https://api.netlify.com/api/v1/badges/a55b97dc-1ba1-4859-994a-db396b196aa7/deploy-status)](https://app.netlify.com/sites/cl-music/deploys)  [![GitHub](https://img.shields.io/github/license/voici5986/SonicFlow)](https://github.com/voici5986/SonicFlow)


![1744334065693](image/README/1744334065693.png)

![1744334075944](image/README/1744334075944.png)

![1744334087360](image/README/1744334087360.png)

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸµ æ”¯æŒå¤šå¹³å°éŸ³ä¹æœç´¢

  - ç½‘æ˜“äº‘éŸ³ä¹
  - QQéŸ³ä¹
  - TIDAL
  - Spotify
  - YouTube Music
  - Qobuz
  - JOOX
  - Deezer
  - å’ªå’•éŸ³ä¹
  - é…·ç‹—éŸ³ä¹
  - é…·æˆ‘éŸ³ä¹
  - å–œé©¬æ‹‰é›…
  
- ğŸ¨ ä¸»è¦åŠŸèƒ½

  - éŸ³ä¹æœç´¢
  - åœ¨çº¿æ’­æ”¾
  - éŸ³ä¹ä¸‹è½½ï¼ˆæ”¯æŒç›´æ¥ä¸‹è½½ã€æ— æŸéŸ³è´¨ï¼‰
  - éŸ³è´¨é€‰æ‹©(æœ€é«˜æ”¯æŒ999kæ— æŸFLAC)
  - æ­Œè¯æ˜¾ç¤º(æ”¯æŒåŒè¯­æ­Œè¯ã€å½“å‰è¡Œ+ä¸‹ä¸€è¡Œé¢„è§ˆ)
  - ä¸“è¾‘å°é¢æ˜¾ç¤º
  - æ”¶è—åŠŸèƒ½ï¼ˆçº¢å¿ƒæ ‡è®°å–œçˆ±çš„æ­Œæ›²ï¼‰
  - æ”¶è—æ­Œå•å¯¼å…¥/å¯¼å‡ºï¼ˆæ”¯æŒè·¨å¹³å°æ­Œæ›²åŒ¹é…ï¼‰
  - æ‰¹é‡ä¸‹è½½æ”¶è—æ­Œæ›²ï¼ˆæ”¯æŒæ— æŸéŸ³è´¨ï¼‰
  - æ’­æ”¾å†å²è®°å½•
  - å“åº”å¼è®¾è®¡å’Œä¼˜åŒ–çš„ç”¨æˆ·ç•Œé¢

## æœ€æ–°æ”¹è¿›

- ğŸ”„ **å¢é‡åŒæ­¥æœºåˆ¶**
  - ä¼˜åŒ–Firebaseèµ„æºä½¿ç”¨ï¼Œå‡å°‘æ•°æ®ä¼ è¾“é‡
  - æ™ºèƒ½æ£€æµ‹å˜æ›´æ•°æ®ï¼ŒåªåŒæ­¥å¿…è¦å†…å®¹
  - æé«˜åŒæ­¥é€Ÿåº¦å’Œæ•ˆç‡ï¼Œç‰¹åˆ«é€‚åˆå…è´¹Firebaseè´¦å·

- ğŸŒ **æ™ºèƒ½åŒºåŸŸæ£€æµ‹**
  - è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·IPåŒºåŸŸï¼Œæä¾›é€‚åˆçš„åŠŸèƒ½æ¨¡å¼
  - ä¸­å›½æ¨¡å¼ï¼šæä¾›åˆè§„çš„æœ¬åœ°åŠŸèƒ½ï¼Œæ— éœ€Firebaseè¿æ¥
  - å®Œæ•´æ¨¡å¼ï¼šæä¾›å…¨éƒ¨åŠŸèƒ½ï¼ŒåŒ…æ‹¬äº‘ç«¯åŒæ­¥
  - ç¦»çº¿æ¨¡å¼ï¼šåœ¨ç½‘ç»œä¸å¯ç”¨æ—¶æä¾›åŸºæœ¬åŠŸèƒ½

- ğŸ“± **åŒæ¨¡å¼éŸ³ä¹æ’­æ”¾å™¨**
  - ç´§å‡‘åº•æ æ¨¡å¼ï¼šä¸å¹²æ‰°å†…å®¹æµè§ˆ
  - å…¨å±æ²‰æµ¸æ¨¡å¼ï¼šæä¾›å®Œæ•´çš„éŸ³ä¹å’Œæ­Œè¯ä½“éªŒ
  - å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»å’Œæš—è‰²èƒŒæ™¯æå‡è§†è§‰ä½“éªŒ
  - é€‚å½“çš„å†…å®¹é¡µåº•éƒ¨é—´è·ï¼Œé¿å…æ’­æ”¾å™¨é®æŒ¡å†…å®¹

- ğŸ¯ **ä¼˜åŒ–çš„é¡µé¢å¸ƒå±€ä¸å¡ç‰‡è®¾è®¡**
  - ç»Ÿä¸€çš„ç½‘æ ¼å¸ƒå±€ï¼Œå„é¡µé¢ä¿æŒä¸€è‡´çš„å¡ç‰‡æ˜¾ç¤ºé£æ ¼
  - ç»†è…»çš„å¡ç‰‡é—´è·ä¸å¸ƒå±€è°ƒæ•´ï¼Œæä¾›æ›´å¥½çš„è§†è§‰ä½“éªŒ
  - å†å²è®°å½•é¡µé¢ä¼˜åŒ–ï¼Œæ—¶é—´æˆ³å¸ƒå±€æ”¹è¿›ä¸ºæ›´ç›´è§‚çš„è®¾è®¡

- ğŸ“¦ **PWAæ”¯æŒä¸ç¦»çº¿åŠŸèƒ½**
  - æ”¯æŒå®‰è£…ä¸ºæœ¬åœ°åº”ç”¨ï¼ˆæ‰‹æœºå’Œæ¡Œé¢ç«¯ï¼‰
  - æ·»åŠ åˆ°ä¸»å±å¹•ï¼Œæä¾›ç±»åŸç”Ÿåº”ç”¨ä½“éªŒ
  - ç¦»çº¿è®¿é—®æ ¸å¿ƒåŠŸèƒ½ï¼Œéšæ—¶éšåœ°äº«å—éŸ³ä¹

- ğŸ“± **ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–**
  - ç«–å±ä½¿ç”¨æç¤º
  - å“åº”å¼å¸ƒå±€åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹è‡ªåŠ¨ä¼˜åŒ–
  - è§¦æ§å‹å¥½çš„æ“ä½œç•Œé¢

- ğŸµ **æ­Œè¯æ˜¾ç¤ºå¢å¼º**
  - åŒæ—¶æ˜¾ç¤ºå½“å‰æ­Œè¯è¡Œå’Œä¸‹ä¸€å¥æ­Œè¯
  - è‡ªåŠ¨é«˜äº®å½“å‰æ’­æ”¾ä½ç½®
  - æ­Œè¯å±•å¼€/æŠ˜å ä¼˜åŒ–
  - æ”¯æŒæ­Œè¯è‡ªåŠ¨æ»šåŠ¨

- ğŸ’¾ **ä¸‹è½½åŠŸèƒ½å®Œå–„**
  - æ”¯æŒç›´æ¥ä¸‹è½½ï¼Œæ— éœ€è·³è½¬
  - æ— æŸFLACæ ¼å¼æ”¯æŒ
  - æ‰¹é‡ä¸‹è½½æ”¶è—æ­Œæ›²
  - å®Œå–„çš„ä¸‹è½½çŠ¶æ€åé¦ˆ

- ğŸ¨ **ç•Œé¢è®¾è®¡æ”¹è¿›**
  - å¯¼èˆªæ è§†è§‰ä¼˜åŒ–
  - åŠ¨ç”»æ•ˆæœå¢å¼ºä¸äº¤äº’åé¦ˆ
  - ç§»åŠ¨ç«¯å“åº”å¼å¸ƒå±€ä¼˜åŒ–
  - å¡ç‰‡æ ·å¼ä¸è½¬åœºåŠ¨ç”»ç¾åŒ–

## åŠŸèƒ½è¯¦è§£

- ğŸ’– **æ”¶è—åŠŸèƒ½**
  - ä¸€é”®æ”¶è—å–œçˆ±çš„æ­Œæ›²
  - åœ¨æ’­æ”¾æ§åˆ¶æ ç›´æ¥æ·»åŠ /ç§»é™¤æ”¶è—
  - æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰æ”¶è—çš„æ­Œæ›²

- ğŸ“¤ **æ”¶è—å¯¼å…¥/å¯¼å‡º**
  - å¯¼å‡ºæ”¶è—åˆ—è¡¨ä¸ºJSONæ–‡ä»¶
  - å¯¼å…¥ä¹‹å‰å¯¼å‡ºçš„æ”¶è—æ–‡ä»¶
  - è·¨å¹³å°æ™ºèƒ½åŒ¹é…æ­Œæ›²ï¼ˆå³ä½¿ä»ä¸åŒéŸ³ä¹å¹³å°å¯¼å…¥ä¹Ÿèƒ½è‡ªåŠ¨åŒ¹é…å¯¹åº”æ­Œæ›²ï¼‰

- ğŸ“œ **å†å²è®°å½•**
  - è‡ªåŠ¨è®°å½•æ’­æ”¾è¿‡çš„æ­Œæ›²
  - æŒ‰æ—¶é—´æ’åºæ˜¾ç¤ºå†å²è®°å½•
  - ä¸€é”®æ¸…ç©ºå†å²è®°å½•

- â˜ï¸ **äº‘ç«¯åŒæ­¥**
  - ä½¿ç”¨Firebaseå®ç°å¤šè®¾å¤‡æ•°æ®åŒæ­¥
  - å¢é‡åŒæ­¥æœºåˆ¶ï¼Œå‡å°‘æ•°æ®ä¼ è¾“å’Œèµ„æºæ¶ˆè€—
  - æ™ºèƒ½åˆå¹¶ç­–ç•¥ï¼Œè§£å†³æ•°æ®å†²çª
  - æ”¯æŒæ”¶è—å’Œå†å²è®°å½•åŒæ­¥

- ğŸŒ **å¤šæ¨¡å¼æ”¯æŒ**
  - å®Œæ•´æ¨¡å¼ï¼šæ‰€æœ‰åŠŸèƒ½å¯ç”¨ï¼ŒåŒ…æ‹¬äº‘ç«¯åŒæ­¥
  - ä¸­å›½æ¨¡å¼ï¼šé€‚åº”ä¸­å›½ç½‘ç»œç¯å¢ƒï¼Œä½¿ç”¨æœ¬åœ°å­˜å‚¨
  - ç¦»çº¿æ¨¡å¼ï¼šæ— ç½‘ç»œç¯å¢ƒä¸‹çš„åŸºæœ¬åŠŸèƒ½æ”¯æŒ

## é¡¹ç›®éƒ¨ç½²
 ç”Ÿäº§ç¯å¢ƒéœ€é…ç½®ä¸€ä¸ªç¯å¢ƒç¼–è¾‘ï¼Œ`REACT_APP_API_BASE` åç«¯APIåœ°å€ï¼Œç”±äºè·¨åŸŸé—®é¢˜ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸€èˆ¬å¡«å†™åä»£ `https://music-api.gdstudio.xyz/api.php` ååœ°å€ï¼Œå¯ä½¿ç”¨nginxã€caddy ç­‰webæœåŠ¡åä»£ï¼Œä¹Ÿå¯æ˜¯cloudflare workeråä»£ï¼Œæˆ‘è¿™è¾¹æä¾›äº†workeråå‘ä»£ç†çš„ä»£ç ï¼Œè§ [worker.js](worker.js) å’Œ [cfworker.js](../cfworker.js)
    æ¨èéƒ¨ç½²åˆ° **Cloudflare Pages**ï¼Œåˆ©ç”¨å…¶å¼ºå¤§çš„è¾¹ç¼˜è®¡ç®—èƒ½åŠ›è§£å†³é™æµå’Œè·¨åŸŸé—®é¢˜ã€‚
    [![Deploy to Cloudflare Pages](https://img.shields.io/badge/Deploy%20to-Cloudflare%20Pages-orange?logo=cloudflare)](https://dash.cloudflare.com/?to=/:account/pages/new) 
    *(ä¸€é”®éƒ¨ç½²ï¼šç‚¹å‡»åé€‰æ‹©æ­¤ä»“åº“ï¼Œæ‰€æœ‰ API è½¬å‘é€»è¾‘å°†é€šè¿‡å†…ç½®çš„ `functions` è‡ªåŠ¨ç”Ÿæ•ˆã€‚)*

## ç¯å¢ƒå˜é‡é…ç½®

é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

- `REACT_APP_API_BASE`: åç«¯APIåœ°å€ï¼Œé»˜è®¤ä¸º `/api`
- `REACT_APP_IPINFO_TOKEN`: IPinfo.io APIä»¤ç‰Œï¼Œç”¨äºIPåœ°åŒºæ£€æµ‹

### é…ç½®æ–¹æ³•

1. **å¼€å‘ç¯å¢ƒ**ï¼š
   åˆ›å»º `.env.development.local` æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
   ```
   REACT_APP_API_BASE=/api
   REACT_APP_IPINFO_TOKEN=your_ipinfo_token
   ```

2. **ç”Ÿäº§ç¯å¢ƒ**ï¼š
   - åˆ›å»º `.env.production.local` æ–‡ä»¶ï¼ˆæœ¬åœ°æ„å»ºï¼‰ï¼Œæˆ–
    - åœ¨éƒ¨ç½²å¹³å°ï¼ˆCloudflare Pages é¢æ¿ï¼‰çš„é¡¹ç›®è®¾ç½® -> ç¯å¢ƒå˜é‡ä¸­é…ç½®ã€‚

**æ³¨æ„**ï¼šç¯å¢ƒå˜é‡æ–‡ä»¶åº”æ·»åŠ åˆ° `.gitignore` ä¸­ï¼Œé¿å…å°†æ•æ„Ÿä¿¡æ¯æäº¤åˆ°ä»£ç åº“ã€‚

**Dockeréƒ¨ç½²**
  - docker 

     ```shell
     docker run -d -p 80:80 --restart always ghcr.io/voici5986/sonicflow:latest
     ```
  - docker-compose

```yaml
services:
    sonicflow:
        image: ghcr.io/voici5986/sonicflow:latest
        restart: always
        ports:
            - '80:80'
```

## FirebaseåŒæ­¥åŠŸèƒ½é…ç½®

å¦‚éœ€å¯ç”¨è´¦å·åŒæ­¥åŠŸèƒ½ï¼Œè¯·å‚è€ƒ [FIREBASE_SETUP.md](FIREBASE_SETUP.md) è¿›è¡ŒFirebaseé…ç½®ã€‚

## æŠ€æœ¯æ ˆ

- React Bootstrap
- Axios
- New Native Audio Engine (åŸºäºåŸç”Ÿ HTML5 Audio å¯¹è±¡)
- React Icons
- React Toastify
- Localforage (æœ¬åœ°æ•°æ®å­˜å‚¨)
- Firebase (äº‘ç«¯æ•°æ®åŒæ­¥)
- Moment.js (æ—¥æœŸæ ¼å¼åŒ–)
- Service Worker (PWAæ”¯æŒ)

## æœ¬åœ°å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Node.js 24.13.0 æˆ–æ›´é«˜ç‰ˆæœ¬ (æœ€æ–° LTSï¼Œæ”¯æŒæœ€æ–° Vite æ„å»º)
- npm æˆ– pnpm

1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/voici5986/SonicFlow.git
```

2. å®‰è£…ä¾èµ–

```bash
cd SonicFlow
npm install
```

3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm start
```

4. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`

## æ„å»ºéƒ¨ç½²

æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼š

```bash
npm run build
```

## é¡¹ç›®ç»“æ„

```
SonicFlow/
    â”œâ”€â”€ public/              # é™æ€æ–‡ä»¶
    â”œâ”€â”€ src/                 # æºä»£ç 
    â”‚   â”œâ”€â”€ App.js          # ä¸»åº”ç”¨ç»„ä»¶
    â”‚   â”œâ”€â”€ index.js        # å…¥å£æ–‡ä»¶
    â”‚   â”œâ”€â”€ components/     # å¯å¤ç”¨ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ AudioPlayer.js  # éŸ³é¢‘æ’­æ”¾å™¨ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ HeartButton.js  # æ”¶è—æŒ‰é’®ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ Navigation.js   # å¯¼èˆªç»„ä»¶
    â”‚   â”‚   â””â”€â”€ ProgressBar.js  # è¿›åº¦æ¡ç»„ä»¶
    â”‚   â”œâ”€â”€ contexts/       # ä¸Šä¸‹æ–‡
    â”‚   â”‚   â”œâ”€â”€ AuthContext.js   # è®¤è¯ä¸Šä¸‹æ–‡
    â”‚   â”‚   â”œâ”€â”€ DeviceContext.js # è®¾å¤‡ä¸Šä¸‹æ–‡
    â”‚   â”‚   â”œâ”€â”€ PlayerContext.js # æ’­æ”¾å™¨ä¸Šä¸‹æ–‡
    â”‚   â”‚   â””â”€â”€ RegionContext.js # åŒºåŸŸä¸Šä¸‹æ–‡
    â”‚   â”œâ”€â”€ pages/          # é¡µé¢ç»„ä»¶ 
    â”‚   â”‚   â”œâ”€â”€ Auth.js       # è®¤è¯é¡µé¢
    â”‚   â”‚   â”œâ”€â”€ Favorites.js  # æ”¶è—é¡µé¢
    â”‚   â”‚   â”œâ”€â”€ History.js    # å†å²è®°å½•é¡µé¢
    â”‚   â”‚   â””â”€â”€ User.js       # ç”¨æˆ·é¡µé¢
    â”‚   â”œâ”€â”€ services/       # æœåŠ¡
    â”‚   â”‚   â”œâ”€â”€ firebase.js     # FirebaseæœåŠ¡
    â”‚   â”‚   â”œâ”€â”€ musicApiService.js # éŸ³ä¹APIæœåŠ¡
    â”‚   â”‚   â”œâ”€â”€ regionDetection.js # åŒºåŸŸæ£€æµ‹æœåŠ¡
    â”‚   â”‚   â”œâ”€â”€ storage.js       # æœ¬åœ°å­˜å‚¨æœåŠ¡
    â”‚   â”‚   â””â”€â”€ syncService.js   # åŒæ­¥æœåŠ¡
    â”‚   â”œâ”€â”€ styles/         # æ ·å¼æ–‡ä»¶
    â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
    â”‚   â””â”€â”€ setupProxy.js   # å¼€å‘ä»£ç†é…ç½®
    â””â”€â”€ package.json        # é¡¹ç›®é…ç½®æ–‡ä»¶
```

## APIæ¥å£

é¡¹ç›®ä½¿ç”¨çš„æ˜¯ç¬¬ä¸‰æ–¹éŸ³ä¹APIæ¥å£ï¼Œé€šè¿‡setupProxy.jsé…ç½®ä»£ç†è®¿é—®ã€‚

åç«¯APIæ¥å£ï¼š`https://music-api.gdstudio.xyz/api.php`

## è®¸å¯è¯

MIT License

## åŠŸèƒ½ç‰¹æ€§

- éŸ³ä¹æœç´¢ä¸æ’­æ”¾
- åœ¨çº¿éŸ³ä¹ä¸‹è½½
- æ”¶è—æ­Œæ›²ç®¡ç†
- æ’­æ”¾å†å²è®°å½•
- å•æ›²å¾ªç¯/éšæœºæ’­æ”¾/åˆ—è¡¨å¾ªç¯å¤šç§æ’­æ”¾æ¨¡å¼
- è´¦å·ç™»å½•ä¸æ•°æ®åŒæ­¥
  - å¤šè®¾å¤‡æ”¶è—å’Œå†å²è®°å½•äº‘ç«¯åŒæ­¥
- æ™ºèƒ½åŒºåŸŸæ£€æµ‹ä¸å¤šæ¨¡å¼æ”¯æŒ
  - å®Œæ•´æ¨¡å¼/ä¸­å›½æ¨¡å¼/ç¦»çº¿æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢